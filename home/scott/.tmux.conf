##### Prefix like GNU Screen
unbind C-b
set -g prefix C-a
bind C-a send-prefix

##### Splits like Screen
bind | split-window -h
bind - split-window -v

##### Windows
bind c new-window
bind n next-window
bind p previous-window
bind k kill-window
bind d detach
bind A command-prompt "rename-window %%"

# Screen-style window list
bind '"' choose-tree -Zw

##### Mouse + copy mode
set -g mouse on
setw -g mode-keys vi

# Don't auto-copy on mouse release in copy mode; just finish the selection
unbind -T copy-mode-vi MouseDragEnd1Pane
unbind -T copy-mode    MouseDragEnd1Pane

bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X stop-selection
bind -T copy-mode    MouseDragEnd1Pane send-keys -X stop-selection

# When ctrl+g is hit, clear the selection but stay in copy mode.
bind -T copy-mode-vi C-g send -X clear-selection
bind -T copy-mode    C-g send -X clear-selection


# Exit copy mode when escape is pressed
# In copy mode, make Escape behave like q: always cancel/exit
unbind Escape
unbind -T copy-mode Escape
unbind -T copy-mode-vi Escape

bind -T copy-mode-vi Escape send -X cancel
bind -T copy-mode    Escape send -X cancel

# Native clipboard support if available
set -g set-clipboard on

# Screen-like copy mode: Enter starts or finishes selection, copies via xclip
bind -T copy-mode-vi Enter if -F '#{selection_active}' \
  'send -X copy-pipe-and-cancel "xclip -in"' \
  'send -X begin-selection'
bind -T copy-mode Enter if -F '#{selection_active}' \
  'send -X copy-pipe-and-cancel "xclip -in"' \
  'send -X begin-selection'

# Explicit yank key
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -in"
bind -T copy-mode y send -X copy-pipe-and-cancel "xclip -in"

# Screen-ish entry to copy/scrollback
bind [ copy-mode

##### “Only” current pane like Screen’s prefix q / Q
bind Q kill-pane -a
bind q kill-pane -a

##### Terminal / colors
set -g default-terminal "screen-256color"